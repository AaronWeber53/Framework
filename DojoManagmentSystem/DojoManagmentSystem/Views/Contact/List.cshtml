@model DojoManagmentSystem.ViewModels.ListViewModel<DojoManagmentSystem.Models.Contact>
@using DojoManagmentSystem.Infastructure.Extensions

<div class="table-responsive" id="pagingList" data-page="@Model.CurrentPage" data-sort="@Model.CurrentSort" data-search="@Model.CurrentSearch" data-baseurl="/Contact/List/@ViewBag.MemberId">
    <table class="table table-hover">
        <thead>
            <tr>
                <th></th>
                <th scope="col">
                    <a data-sort="@ViewBag.NameSortParm" href="" class="sortbutton">Name</a>
                </th>
                <th scope="col">
                    Relationship
                </th>
                <th scope="col">
                    Phone
                </th>
                <th scope="col">
                    Email
                </th>
                <th scope="col">
                    Address
                </th>
                <th scope="col">
                    IsPrimary
                </th>
                <th scope="col"></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.ObjectList)
            {
                <tr id="linkRow" data-link="/Contact/Details/@item.Id">
                    <td scope="row">
                        <a class="btn btn-primary" href="/Contact/Details/@item.Id">
                            <i class="fas fa-external-link-alt"></i>
                        </a>
                    </td>
                    <td scope="row">
                        @Html.DisplayFor(modelItem => item.Name)
                    </td>
                    <td scope="row">
                        @Html.DisplayFor(modelItem => item.RelationShip)
                    </td>
                    <td scope="row">
                        @{
                            string output = null;
                            foreach (DojoManagmentSystem.Models.MemberPhone phone in item.MemberPhones)
                            {
                                if (phone.IsArchived == false)
                                {
                                    if (phone.ContactID == item.Id)
                                    {
                                        output = phone.PhoneNumber;
                                        break;
                                    }
                                }
                            }

                            if (output == null)
                            {
                                <button type="button" class="btn btn-sm btn-primary modal-link" data-targeturl="/MemberPhone/Create/@item.Id">
                                    <i class="fas fa-plus"></i>
                                </button>
                            }
                            else
                            {
                                <label>@output</label>
                            }
                        }
                    </td>
                    <td scope="row">

                        @{
                            output = null;
                            foreach (DojoManagmentSystem.Models.MemberEmail email in item.MemberEmails)
                            {
                                if (email.IsArchived == false)
                                {
                                    if (email.ContactID == item.Id)
                                    {
                                        output = email.Email;
                                        break;
                                    }
                                }
                            }

                            if (output == null)
                            {
                                <button type="button" class="btn btn-sm btn-primary modal-link" data-targeturl="/MemberEmail/Create/@item.Id">
                                    <i class="fas fa-plus"></i>
                                </button>
                            }
                            else
                            {
                                <label>@output</label>
                            }
                        }
                    </td>
                    <td scope="row">

                        @{
                            output = null;
                            foreach (DojoManagmentSystem.Models.MemberAddress address in item.MemberAddresses)
                            {
                                if (address.IsArchived == false)
                                {
                                    if (address.ContactID == item.Id)
                                    {
                                        output = address.FullAddress;
                                        break;
                                    }
                                }
                            }

                            if (output == null)
                            {
                                <button type="button" class="btn btn-sm btn-primary modal-link" data-targeturl="/MemberAddress/Create/@item.Id">
                                    <i class="fas fa-plus"></i>
                                </button>
                            }
                            else
                            {
                                <label>@output</label>
                            }
                        }
                    </td>
                    <td scope="row">
                        @Html.DisplayFor(modelItem => item.IsPrimary)
                    </td>
                    <td>
                        <button type="button" class="btn btn-danger modal-link" data-targeturl="/Contact/Delete/@item.Id">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    @Html.GeneratePagingButtons(Model)
</div>